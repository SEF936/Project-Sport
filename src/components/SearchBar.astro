---
---

<div class="mb-8">
  <input 
    type="text" 
    id="search-input"
    placeholder="Rechercher des articles..."
    class="w-full px-4 py-3 bg-slate-800 text-white rounded-lg border border-slate-700 focus:border-orange-500 focus:outline-none placeholder-slate-500"
  />
</div>

<div id="search-results" class="hidden">
  <div class="mb-4">
    <p class="text-slate-400 text-sm">Résultats trouvés: <span id="result-count">0</span></p>
  </div>
  <div id="results-container" class="space-y-4"></div>
</div>

<div id="no-results" class="hidden text-center py-8">
  <p class="text-slate-400">Aucun résultat trouvé. Essayez d'autres mots-clés.</p>
  <button id="reset-search" class="mt-4 px-4 py-2 bg-orange-500 text-white rounded hover:bg-orange-600 transition">
    Réinitialiser
  </button>
</div>

<script>
  const searchInput = document.getElementById('search-input') as HTMLInputElement;
  const searchResults = document.getElementById('search-results') as HTMLElement;
  const resultsContainer = document.getElementById('results-container') as HTMLElement;
  const resultCount = document.getElementById('result-count') as HTMLElement;
  const noResults = document.getElementById('no-results') as HTMLElement;
  const resetButton = document.getElementById('reset-search') as HTMLButtonElement;

  let searchIndex: any = [];

  // Load search index
  fetch('/search-index.json')
    .then(res => res.json())
    .then(data => {
      searchIndex = data;
    });

  searchInput.addEventListener('input', (e) => {
    const query = (e.target as HTMLInputElement).value.toLowerCase();
    
    if (!query) {
      searchResults.classList.add('hidden');
      noResults.classList.add('hidden');
      return;
    }

    const results = searchIndex.filter((item: any) => 
      item.title.toLowerCase().includes(query) ||
      item.excerpt.toLowerCase().includes(query) ||
      item.tags.some((tag: string) => tag.toLowerCase().includes(query))
    );

    if (results.length === 0) {
      searchResults.classList.add('hidden');
      noResults.classList.remove('hidden');
      return;
    }

    searchResults.classList.remove('hidden');
    noResults.classList.add('hidden');
    resultCount.textContent = results.length.toString();
    
    resultsContainer.innerHTML = results.map((item: any) => `
      <a href="/blog/${item.slug}" class="block p-4 bg-slate-800 rounded-lg hover:bg-slate-700 transition">
        <h3 class="font-bold text-orange-400">${item.title}</h3>
        <p class="text-slate-400 text-sm">${item.excerpt}</p>
      </a>
    `).join('');
  });

  resetButton.addEventListener('click', () => {
    searchInput.value = '';
    searchResults.classList.add('hidden');
    noResults.classList.add('hidden');
  });
</script>